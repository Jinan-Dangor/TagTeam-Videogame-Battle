(function(){"use strict";let D=!1,H=!1,x=[],P=!1,I=[],S=[],v;const K=e=>{const t=typeof $=="function"&&typeof $.fn=="object"&&typeof $.fn.dataTable=="function";let o=t?[]:document.querySelectorAll(".app"),a=t?[]:document.querySelectorAll(".package");t&&($($.fn.dataTable.tables()).each(function(){const n=$(this).DataTable().table();o=n.rows(".app").nodes().reduce(function(s,l){return s.push(l),s},o),a=n.rows(".package").nodes().reduce(function(s,l){return s.push(l),s},a)}),o.length===0&&document.body.classList.contains("page-calculator")&&(o=document.querySelectorAll(".app")));const u=[],f=[];for(const n of o){const s=+n.dataset.appid,l=u[s];l?l.push(n):u[s]=[n]}o=null;for(const n of a){const s=+n.dataset.subid,l=f[s];l?l.push(n):f[s]=[n]}if(a=null,e.rgFollowedApps){window.SteamDB.FollowedApps=new Set(e.rgFollowedApps);for(const n of e.rgFollowedApps){const s=u[n];if(s)for(const l of s)l.classList.add("followed")}}if(e.rgWishlist){window.SteamDB.WishedApps=new Set(e.rgWishlist);for(const n of e.rgWishlist){const s=u[n];if(s)for(const l of s)l.classList.add("wished")}}if(e.rgAppsInCart)for(const n of e.rgAppsInCart){const s=u[n];if(s)for(const l of s)l.classList.add("cart")}if(e.rgOwnedApps){window.SteamDB.OwnedApps=new Set(e.rgOwnedApps);for(const n of e.rgOwnedApps){const s=u[n];if(s)for(const l of s)l.classList.add("owned")}}if(e.rgIgnoredApps)for(let n of Object.keys(e.rgIgnoredApps)){n=+n,window.SteamDB.IgnoredApps.add(n);const s=u[n];if(s)for(const l of s)l.classList.add("ignored")}if(e.rgOwnedPackages&&(window.SteamDB.OwnedPackages=new Set(e.rgOwnedPackages)),window.SteamDB.OwnedPackages.add(0),f.length>0){if(e.rgPackagesInCart)for(const n of e.rgPackagesInCart){const s=f[n];if(s)for(const l of s)l.classList.add("cart")}if(e.rgOwnedPackages)for(const n of e.rgOwnedPackages){const s=f[n];if(s)for(const l of s)l.classList.add("owned")}}};window.SteamDB={FollowedApps:new Set,IgnoredApps:new Set,OwnedApps:new Set,WishedApps:new Set,OwnedPackages:new Set,OnExtensionUserdataLoaded:e=>{if(P){e();return}I.push(e)},EnhanceLazyLoadedApps:e=>{const t=e.querySelectorAll(".app");for(const o of t){const a=+o.dataset.appid;window.SteamDB.FollowedApps.has(a)&&o.classList.add("followed"),window.SteamDB.WishedApps.has(a)&&o.classList.add("wished"),window.SteamDB.OwnedApps.has(a)&&o.classList.add("owned"),window.SteamDB.IgnoredApps.has(a)&&o.classList.add("ignored")}window.SteamDB.BindHover(e)},BindHover:()=>{},HideHoverIfAny:()=>{},Alert:(e,t=null)=>{const o=document.createElement("toast-notification");return t!==null&&(o.title=t),o.body=e,document.querySelector("#js-notifications").append(o),o},Storage:{Get:function(e){try{return window.localStorage.getItem(e)}catch{return null}},Set:function(e,t){try{window.localStorage.setItem(e,t)}catch{}},Remove:function(e){try{window.localStorage.removeItem(e)}catch{}}},LazyLoad:function(e,t){if(!("IntersectionObserver"in window)){t();return}v||(v=new window.IntersectionObserver(o=>{o.forEach(a=>{a.isIntersecting&&(v.unobserve(a.target),a.target.dispatchEvent(new Event("lazyload")))})})),v.observe(e),e.addEventListener("lazyload",t,{once:!0})},ImageError:function(e){e.complete&&e.naturalWidth===0?e.src="/static/img/applogo.svg":e.addEventListener("error",function(){this.src="/static/img/applogo.svg"},{once:!0})},RequirePageScreenshotViewer:function(e,t=!1){if(t){for(let o=0;o<S.length;o++)S[o](e);S=[],window.SteamDB.RequirePageScreenshotViewer=o=>o(e)}else S.push(e)},RequireHighstock:function(e){if(window.Highcharts){W(),e();return}if(x.push(e),D)return;D=!0;const t=document.createElement("script");t.nonce=document.querySelector("script[nonce]").nonce,t.src="/static/js/vendor/highstock.js?v=bca974cb386bbecb",t.integrity="sha512-vKl0yzhrvsvMKIIY+NA4afeQ8j3GoWRYulr1nEhQbMg4bU6u4qXAh/MYTVeX3P93OR65kIcvMW+J/cjy6hIUHg==",t.async=!0,t.addEventListener("load",function(){W();for(const o of x)o();x=[],D=!1}),document.head.appendChild(t)}};const W=()=>{H||(H=!0,window.Highcharts.setOptions({accessibility:{enabled:!1},chart:{animation:!1,zooming:{type:"x",mouseWheel:{enabled:!1}},backgroundColor:"transparent",spacing:[5,0,15,0],style:{fontSize:"16px",fontFamily:"inherit"}},title:{style:{color:"var(--body-color)"}},yAxis:{gridLineColor:"rgba(180, 180, 180, 0.2)",labels:{style:{color:"var(--muted-color)"}}},xAxis:{lineColor:"var(--border-color)",tickColor:"var(--border-color)",crosshair:{width:30,color:"rgba(180, 180, 180, 0.2)"},labels:{style:{color:"var(--body-color)"}}},legend:{itemHoverStyle:{color:"var(--link-color)"},itemHiddenStyle:{color:"var(--border-color)"},itemStyle:{color:"var(--body-color)",fontSize:"16px",fontWeight:"400"}},plotOptions:{series:{animation:!1,dataGrouping:{enabled:!1},states:{hover:{lineWidthPlus:0}}}},credits:{text:"data by SteamDB.info (powered by highcharts.com)",position:{x:0,y:-3},style:{fontSize:"12px",color:"var(--muted-color)"}},exporting:{buttons:{contextButton:{symbol:"url(/static/img/download.svg)",symbolSize:24,symbolX:26,symbolY:24,menuItems:["downloadCSV","downloadXLS"],theme:{fill:"none",states:{hover:{fill:"var(--border-color-2)"},select:{fill:"var(--border-color)"}}}}}},navigation:{menuStyle:{borderRadius:"6px",borderColor:"var(--border-color)",background:"var(--tooltip-bg)",boxShadow:"-8px -8px 24px rgba(149, 157, 165, 0.2)"},menuItemStyle:{color:"var(--body-bg-color)",transition:"none",fontSize:"14px"}},rangeSelector:{inputEnabled:!1,labelStyle:{color:"var(--body-color)"},buttonTheme:{width:"auto",height:24,paddingLeft:10,paddingRight:10,fill:"none",r:6,stroke:"var(--border-color)","stroke-width":"1px",style:{color:"var(--link-color)",fontSize:"16px",fontWeight:"bold"},states:{hover:{fill:"var(--border-color)",style:{color:"var(--link-color-hover)"}},select:{fill:"var(--border-color)",style:{color:"var(--body-color)"}},disabled:{"stroke-width":0,style:{color:"var(--border-color)"}}}}},navigator:{handles:{backgroundColor:"var(--border-color-2)",borderColor:"var(--link-color)"},xAxis:{gridLineColor:"var(--border-color)",labels:{style:{color:"var(--muted-color)",opacity:1}}},series:{lineWidth:2},outlineColor:"var(--border-color)"},tooltip:{shared:!0,split:!1,shadow:!1,borderWidth:0,borderRadius:6,headerFormat:"{point.key} UTC<br/>",backgroundColor:"var(--tooltip-bg)",style:{fontSize:"14px",color:"var(--body-bg-color)"}}}))},B=(e,t,o)=>{document.querySelectorAll(e).forEach(a=>{o?a.classList.add(t):a.classList.remove(t)})},w=(e,t,o)=>B(`.app[data-appid="${e}"]`,t,o),k=(e,t,o)=>B(`.package[data-subid="${e}"]`,t,o),j=(e,t,o)=>B(`.bundle[data-bundleid="${e}"]`,t,o),_=e=>{if(!(!e.response||!e.response.success)){if(e.request.appid>0){const t=e.request.appid;switch(e.request.contentScriptQuery){case"StoreWishlistAdd":window.SteamDB.WishedApps.add(t),w(t,"wished",!0);break;case"StoreWishlistRemove":window.SteamDB.WishedApps.delete(t),w(t,"wished",!1);break;case"StoreFollow":window.SteamDB.FollowedApps.add(t),w(t,"followed",!0);break;case"StoreUnfollow":window.SteamDB.FollowedApps.delete(t),w(t,"followed",!1);break;case"StoreIgnore":window.SteamDB.IgnoredApps.add(t),w(t,"ignored",!0);break;case"StoreUnignore":window.SteamDB.IgnoredApps.delete(t),w(t,"ignored",!1);break;case"Watch":w(t,"watched",!0);break;case"Unwatch":w(t,"watched",!1);break}}else if(e.request.subid>0){const t=e.request.subid;switch(e.request.contentScriptQuery){case"StoreAddToCart":k(t,"cart",!0);break;case"StoreAddFreeLicense":k(t,"owned",!0);break;case"Watch":k(t,"watched",!0);break;case"Unwatch":k(t,"watched",!1);break}}else if(e.request.bundleid>0){const t=e.request.bundleid;switch(e.request.contentScriptQuery){case"Watch":j(t,"watched",!0);break;case"Unwatch":j(t,"watched",!1);break}}}};if("BroadcastChannel"in window){let e=null;try{e=new BroadcastChannel("steamdb-extension"),e.addEventListener("message",t=>{t&&t.data&&t.data.type==="steamdb:extension-response"&&_(t.data)})}catch{}window.addEventListener("message",t=>{if(!(!t||!t.data)&&t.origin===window.location.origin)if(t.data.type==="steamdb:extension-loaded"){P=!0,K(t.data.data);for(const o of I)o();I=[]}else if(t.data.type==="steamdb:extension-init")document.querySelectorAll(".js-extension-tip").forEach(o=>{o.hidden=!0}),"OnExtensionInit"in window.SteamDB&&window.SteamDB.OnExtensionInit(t.data.data);else if(t.data.type==="steamdb:extension-error"){try{if(window.sessionStorage.getItem("extension_error_hidden")&&location.pathname!=="/freepackages/")return}catch{}const o=window.SteamDB.Alert(t.data.error,"Extension error");if(typeof InstallTrigger<"u"||navigator.userAgent.includes(" Firefox/")){const u=document.createElement("div");u.textContent="If you use Firefox containers, extension is not compatible with it.",o.append(u)}const a=document.createElement("a");a.className="btn btn-sm btn-primary",a.href="https://store.steampowered.com/login/",a.textContent="Sign in on the Steam Store",o.append(a),o.addEventListener("toast-close",()=>{try{window.sessionStorage.setItem("extension_error_hidden","1")}catch{}})}else t.data.type==="steamdb:extension-response"&&(e!==null&&e.postMessage(t.data),_(t.data),(!t.data.response||!t.data.response.success)&&!location.pathname.startsWith("/freepackages/")&&(window.SteamDB.Alert(`Something went wrong.
`+(t.data.response&&t.data.response.error||"Unknown error. Are you logged in on the Steam store?"),"Extension error"),console.error(t.data.response)))})}const Q=e=>{const t=[];if(e.forEach((o,a)=>{const u=a.toLowerCase();(u==="__cf_chl_captcha_tk__"||u==="__cf_chl_jschl_tk__"||u==="ref"||u==="fbclid"||u.startsWith("utm_"))&&t.push(a)}),t.length>0){for(const o of t)e.delete(o);window.history.replaceState(null,null,Array.from(e).length?`${location.pathname}?${e}`:location.pathname)}},b=document.querySelector(".header"),m=document.querySelector(".header-menu-container"),A=document.querySelector("#js-header-hamburger"),q=document.querySelector(".account-menu"),F=document.querySelector(".header-user-avatar");F&&F.addEventListener("click",e=>{e.preventDefault(),q.hidden=!q.hidden}),A.addEventListener("click",function(e){m.hidden=!m.hidden,m.hidden||(m.querySelector(".header-menu").focus(),b.classList.remove("header-search-focus"),window.SteamDB.HideHoverIfAny())}),m.addEventListener("click",function(e){e.target.className===m.className&&(m.hidden=!0)});const C=document.getElementById("js-header-form"),g=C.querySelector(".field");document.addEventListener("keydown",e=>{if(e.key==="Escape"){if(document.documentElement.classList.contains("js-screenshots-shown"))return;m.hidden?b.classList.remove("header-search-focus"):(m.hidden=!0,A.focus())}e.ctrlKey||e.metaKey||["INPUT","TEXTAREA","SELECT","BUTTON"].includes(e.target.tagName)&&e.target!==A||(e.code==="Slash"||e.code==="KeyS"||e.key==="/"||e.key==="s"?(e.preventDefault(),g.focus()):(e.code==="KeyM"||e.key==="m")&&A.click())});function X(){this.src="/static/p.gif"}if(C){C.addEventListener("submit",function(c){const i=g.value.replace(/^\s+|\s+$/g,"");let r=i.match(/^([0-9]{1,7})$/);if(r!==null){window.location=`/app/${r[0]}/`,c.preventDefault();return}if(r=i.match(/(7656119[0-9]{10})/),r!==null){window.location=`/calculator/${r[1]}/`,c.preventDefault();return}if(r=i.match(/(?:id|profiles)\/([\d\w-]+)/),r!==null){window.location=`/calculator/?player=${r[1]}`,c.preventDefault();return}r=i.match(/(app|sub|bundle|depot|dlc)\/([0-9]{1,8})/),r!==null&&(r[1]==="dlc"&&(r[1]="app"),window.location=`/${r[1]}/${r[2]}/`,c.preventDefault())},!1);const e=document.getElementById("js-search-suggestions"),t=document.getElementById("js-search-tips"),o=new Map;let a=0,u=0,f="",n;const s=t.dataset.a,l={Accept:"application/json","x-algolia-application-id":s,"x-algolia-api-key":t.dataset.k},R=()=>{a=0;const c={hitsPerPage:10,attributesToSnippet:null,attributesToHighlight:"name",attributesToRetrieve:"objectID,lastUpdated",query:f};n&&n.abort(),n=new AbortController,fetch(`https://${s}-dsn.algolia.net/1/indexes/steamdb/query?x-algolia-agent=SteamDB%20Autocompletion`,{method:"POST",body:JSON.stringify(c),signal:n.signal,headers:l}).then(i=>i.json()).then(i=>{o.set(c.query,i),n=null,T(i)}).catch(console.error)},Y=()=>{a=0;const c={hitsPerPage:20,attributesToSnippet:null,attributesToHighlight:"name",attributesToRetrieve:"type,id,lastUpdated",query:f};n&&n.abort(),n=new AbortController,fetch(`https://${s}-dsn.algolia.net/1/indexes/all_names/query?x-algolia-agent=SteamDB%20Autocompletion`,{method:"POST",body:JSON.stringify(c),signal:n.signal,headers:l}).then(i=>i.json()).then(i=>{n=null,T(i,!1)}).catch(console.error)},T=(c,i=!0)=>{const r=document.body.dataset.storeAssets;let L=-1;const z=new Set;if(i){const d=e.querySelector(".focus");if(d&&(L=+d.dataset.appid),t.hidden=!0,e.replaceChildren(),window.SteamDB.HideHoverIfAny(),!c.nbHits){const p=document.createElement("span");c.message?p.innerText=`Algolia error: ${c.message}`:(p.innerText="No results found.",M()),e.appendChild(p);return}}else{if(!c.nbHits)return;const d=o.get(f);if(d)for(const p of d.hits)z.add(`a${p.objectID}`)}let N="",V=0;{const d=location.pathname.match(/\/app\/[0-9]+\/(?<page>\w+)/);d&&(N=`${d.groups.page}/`)}for(const d of c.hits){if(z.has(d.objectID))continue;const p=document.createElement("a");i?(d.type="app",d.id=+d.objectID):(d.lastUpdated=0,p.classList.add("app-small"));let U="/static/img/applogo.svg",y=d._highlightResult.name.value;switch(i||(y=`${y} <span class="muted">(${d.type}/${d.id})</span>`),d.type){case"app":{const h=d.id;p.classList.add("app"),p.dataset.appid=h,p.href=`/app/${h}/${N}`,p.innerHTML=y,window.SteamDB.OwnedApps.has(h)?p.classList.add("owned"):window.SteamDB.WishedApps.has(h)?p.classList.add("wished"):window.SteamDB.FollowedApps.has(h)&&p.classList.add("followed"),L===h&&(L=-1,p.classList.add("focus")),U=`${r}apps/${h}/capsule_sm_120.jpg?t=${d.lastUpdated}`;break}case"sub":{const h=d.id;p.classList.add("app"),p.href=`/sub/${h}/`,p.innerHTML=y,window.SteamDB.OwnedPackages.has(h)&&p.classList.add("owned"),U=`${r}subs/${h}/capsule_sm_120.jpg`;break}case"bundle":{const h=d.id;p.classList.add("app"),p.href=`/bundle/${h}/`,p.innerHTML=y;break}}const E=document.createElement("img");if(E.addEventListener("error",X,{once:!0}),E.alt="",E.src=U,p.prepend(E),e.appendChild(p),++V>10)break}if(i){if(L>-1){const d=e.firstElementChild;d&&d.classList.add("focus")}window.SteamDB.BindHover(e),window.innerHeight>200+V*55&&M()}},M=()=>{clearTimeout(a),u=1/0,a=setTimeout(Y,1e3)},O=()=>{b.classList.add("header-search-focus"),m.hidden=!0,window.SteamDB.HideHoverIfAny()};g.addEventListener("keydown",function(c){if(c.key==="ArrowUp"||c.key==="ArrowDown"){c.preventDefault();const i=e.querySelector(".focus");let r;c.key==="ArrowUp"?(i&&(r=i.previousSibling),r||(r=e.lastElementChild)):(i&&(r=i.nextSibling),r||(r=e.firstElementChild)),r&&(i&&i.classList.remove("focus"),r.classList.add("focus"))}else if(c.key==="Enter"){if(c.ctrlKey){const r=new URLSearchParams;r.append("query",f),window.location.href=`/instantsearch/?${r.toString()}`,c.preventDefault();return}const i=e.querySelector(".focus");i&&(i.click(),c.preventDefault())}else c.key==="Escape"&&g.blur()}),g.addEventListener("input",function(){O();const c=this.value;if(!c||c.length>200){e.replaceChildren(),f="",t.hidden=!1,window.SteamDB.HideHoverIfAny();return}if(f===c)return;f=c;const i=o.get(f);if(i){clearTimeout(a),a=0,T(i);return}const r=Date.now();if(a){r-u<200&&(clearTimeout(a),u=r,a=setTimeout(R,200));return}u=r,a=setTimeout(R,350)}),document.querySelector(".header-search-close").addEventListener("click",()=>{b.classList.remove("header-search-focus")}),document.querySelector(".header-search-side-close").addEventListener("click",()=>{b.classList.remove("header-search-focus")}),document.querySelector(".header-search-mobile").addEventListener("click",()=>{O(),g.focus()}),g.addEventListener("focus",O)}if(window.location.hostname==="steamdb.info"){const e=new URLSearchParams(location.search);Q(e)}"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).catch(e=>{console.error(e)})})();
